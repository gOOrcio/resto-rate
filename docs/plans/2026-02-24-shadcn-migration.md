# Flowbite → shadcn-svelte Migration Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Replace all Flowbite Svelte components with shadcn-svelte, using Lucide icons (`@lucide/svelte` is already installed), clean-slate theme, and Svelte `fly` transition for the RestaurantCard panel.

**Architecture:** Big bang — all 6 affected files are rewritten in one pass. Flowbite packages are removed first, then shadcn-svelte is initialized, then each component is rewritten. The app will be broken between Task 1 and Task 9.

**Tech Stack:** SvelteKit 5 (runes), shadcn-svelte, TailwindCSS v4, `@lucide/svelte` (already in deps), bits-ui (auto-installed by shadcn), Svelte `fly` transition.

---

## Component inventory

| File | Flowbite components used | Replacement |
|---|---|---|
| `src/routes/+layout.svelte` | `ThemeProvider` | removed |
| `src/lib/ui/navigation/Footer.svelte` | `Hr` | plain `<hr>` |
| `src/lib/ui/navigation/Header.svelte` | `Navbar`, `NavBrand`, `NavUl`, `NavLi`, `NavHamburger`, `Drawer`, `Hr`, `Button` | shadcn `Button`, shadcn `Sheet`, semantic HTML, plain `<hr>` |
| `src/lib/ui/components/LoginModal.svelte` | `Button`, `Input`, `Label`, `Helper`, `CloseOutline` | shadcn `Button`/`Input`/`Label`, plain `<p>`, Lucide `X` |
| `src/lib/ui/components/RestaurantSearchSv.svelte` | `Input` | shadcn `Input` |
| `src/lib/ui/components/RestaurantCard.svelte` | `Rating`, `Star`, `Spinner`, `RatingIconProps`, 8 icon imports | hand-rolled stars, Lucide `Loader2`, 8 Lucide icon swaps, Svelte `fly` |

## Icon mapping

| flowbite-svelte-icons | `@lucide/svelte` |
|---|---|
| `EditOutline` | `Pencil` |
| `CheckOutline` | `Check` |
| `CloseOutline` | `X` |
| `MapPinAltOutline` | `MapPin` |
| `ChevronRightOutline` | `ChevronRight` |
| `ChevronLeftOutline` | `ChevronLeft` |
| `PhoneOutline` | `Phone` |
| `GlobeOutline` | `Globe` |

---

## Task 1: Remove Flowbite packages

**Files:**
- Modify: `apps/web/package.json`

**Step 1: Remove flowbite packages from package.json devDependencies**

Remove these three lines from `devDependencies` in `apps/web/package.json`:
```json
"flowbite": "^3.1.2",
"flowbite-svelte": "^1.12.6",
"flowbite-svelte-icons": "^2.3.0",
```

**Step 2: Run bun install to sync the lockfile**

```bash
cd apps/web && bun install
```

Expected: bun removes the flowbite packages from node_modules, no errors.

---

## Task 2: Initialize shadcn-svelte

**Files:**
- Create: `apps/web/components.json` (auto-generated by CLI)
- Create: `apps/web/src/lib/utils.ts` (auto-generated by CLI)
- Modify: `apps/web/src/app.css` (CLI appends CSS variables)

**Step 1: Run shadcn-svelte init**

```bash
cd apps/web && bunx shadcn-svelte@latest init
```

When prompted, answer as follows:
- **Which style would you like to use?** → `Default`
- **Which color would you like to use as the base color?** → `Slate` (or any neutral — clean slate, doesn't matter)
- **Where is your global CSS file?** → `src/app.css`
- **Do you want to use CSS variables for theming?** → `Yes`
- **Where is your tailwind.config located?** → (if Tailwind v4 is auto-detected, accept default; it may skip this)
- **Configure the import alias for components?** → `$lib/components`
- **Configure the import alias for utils?** → `$lib/utils`
- **Are you using Svelte 5?** → `Yes`

Expected: `components.json` is created, `src/lib/utils.ts` is created with a `cn()` function, CSS variables are added to `app.css`.

**Step 2: Install the components we need**

```bash
cd apps/web && bunx shadcn-svelte@latest add button input label sheet
```

Expected: Files created in `src/lib/components/ui/`:
- `button.svelte`
- `input.svelte`
- `label.svelte`
- `sheet.svelte` (and `sheet-content.svelte`, `sheet-trigger.svelte`, etc.)

---

## Task 3: Clean up app.css and delete theme files

**Files:**
- Modify: `apps/web/src/app.css`
- Delete: `apps/web/src/resto-rate-theme.css`
- Delete: `apps/web/src/lib/ui/theme/index.ts` (entire file)

**Step 1: Rewrite app.css**

Replace the entire content of `apps/web/src/app.css` with (keep shadcn CSS vars that were added by the init command, add them below the imports):

```css
@import 'tailwindcss';
@import 'tw-animate-css';
@plugin '@tailwindcss/forms';
@plugin '@tailwindcss/typography';

@custom-variant dark (&:where(.dark, .dark *));

/* shadcn-svelte CSS variables are added here by `bunx shadcn-svelte init` */
/* (keep the @layer base { :root { ... } } block that was generated) */

@layer base {
    /* disable chrome cancel button */
    input[type="search"]::-webkit-search-cancel-button {
        display: none;
    }
}
```

In practice: remove the `@plugin 'flowbite/plugin'` line, remove the `@theme { --color-secondary-* ... --color-primary-* }` block, remove `@source "../node_modules/flowbite-svelte/dist"` and `@source "../node_modules/flowbite-svelte-icons/dist"` lines. Keep everything else including whatever the shadcn init added.

**Step 2: Delete the theme files**

```bash
rm apps/web/src/resto-rate-theme.css
rm apps/web/src/lib/ui/theme/index.ts
```

---

## Task 4: Update +layout.svelte

**Files:**
- Modify: `apps/web/src/routes/+layout.svelte`

**Step 1: Replace the entire file**

```svelte
<script lang="ts">
	import '../app.css';
	import Footer from '$lib/ui/navigation/Footer.svelte';
	import Header from '$lib/ui/navigation/Header.svelte';
	import { onMount } from 'svelte';
	import client from '$lib/client/client';
	import { auth } from '$lib/state/auth.svelte';

	let { children } = $props();

	onMount(async () => {
		try {
			const res = await client.auth.getCurrentUser({});
			if (res.user) {
				auth.setUser(res.user);
			}
		} catch {
			// Not authenticated — ignore
		}
	});
</script>

<div
	class="flex min-h-screen flex-col bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50"
>
	<Header />

	<main class="flex-grow">
		{@render children()}
	</main>

	<Footer />
</div>
```

Changes: removed `ThemeProvider` import + wrapper, removed `appTheme` import, removed dark mode gradient classes (clean slate).

---

## Task 5: Update Footer.svelte

**Files:**
- Modify: `apps/web/src/lib/ui/navigation/Footer.svelte`

**Step 1: Replace the entire file**

```svelte
<footer class="bg-blue-200 py-8">
	<div class="container mx-auto max-w-6xl px-6">
		<div class="flex flex-col items-center space-y-4 text-center">
			<!-- Logo and Brand -->
			<div class="flex items-center space-x-3">
				<img src="/resto-rate-logo.svg" class="h-8 w-8" alt="App Logo" />
				<span class="text-xl font-bold text-blue-800">Restorate</span>
			</div>

			<hr class="mx-auto h-0.5 w-16 rounded-sm border-0 bg-blue-400" />

			<!-- Footer Links -->
			<nav class="flex flex-wrap justify-center gap-6 text-sm">
				<a href="/" class="text-blue-700 transition-colors hover:text-blue-800">Home</a>
				<a href="/about" class="text-blue-700 transition-colors hover:text-blue-800">About</a>
				<a href="/pricing" class="text-blue-700 transition-colors hover:text-blue-800">Pricing</a>
				<a href="/contact" class="text-blue-700 transition-colors hover:text-blue-800">Contact</a>
			</nav>

			<p class="text-sm text-blue-600">© 2024 Restorate. All rights reserved.</p>
		</div>
	</div>
</footer>
```

Changes: removed `Hr` import, replaced with plain `<hr>`, removed dark mode classes.

---

## Task 6: Update Header.svelte

**Files:**
- Modify: `apps/web/src/lib/ui/navigation/Header.svelte`

shadcn-svelte Sheet component provides a slide-in drawer. Import it along with `SheetContent`, `SheetTrigger`, `SheetHeader` from the generated files. The exact export names depend on what shadcn generated — check `src/lib/components/ui/sheet.svelte` for the exports.

**Step 1: Replace the entire file**

```svelte
<script lang="ts">
	import { page } from '$app/state';
	import { Button } from '$lib/components/ui/button/index.js';
	import * as Sheet from '$lib/components/ui/sheet/index.js';
	import { auth } from '$lib/state/auth.svelte';
	import LoginModal from '$lib/ui/components/LoginModal.svelte';
	import client from '$lib/client/client';

	let loginOpen = $state(false);
	let activeUrl = $derived(page.url.pathname);

	function isActive(href: string) {
		return activeUrl === href;
	}

	async function handleLogout() {
		try {
			await client.auth.logout({});
		} finally {
			auth.setUser(null);
		}
	}
</script>

<header class="sticky top-0 z-10 w-full bg-blue-200 p-2 shadow-sm">
	<nav class="flex w-full items-center justify-between px-2">
		<!-- Brand -->
		<a href="/" class="flex items-center gap-2">
			<img src="/resto-rate-logo.svg" class="h-5 w-5" alt="App Logo" />
			<span class="self-center whitespace-nowrap text-xl font-semibold text-blue-800">
				Restorate
			</span>
		</a>

		<!-- Desktop nav links -->
		<ul class="hidden items-center gap-6 md:flex">
			{#each [{ href: '/', label: 'Home' }, { href: '/about', label: 'About' }, { href: '/pricing', label: 'Pricing' }, { href: '/contact', label: 'Contact' }] as link}
				<li>
					<a
						href={link.href}
						class="text-sm font-medium transition-colors {isActive(link.href)
							? 'text-blue-700 underline underline-offset-4'
							: 'text-gray-700 hover:text-blue-700'}"
					>
						{link.label}
					</a>
				</li>
			{/each}
		</ul>

		<!-- Auth controls + mobile hamburger -->
		<div class="flex items-center gap-2">
			{#if auth.isLoggedIn}
				<span class="hidden text-sm text-gray-700 sm:inline">{auth.user?.username}</span>
				<Button size="sm" variant="outline" onclick={handleLogout}>Logout</Button>
			{:else}
				<Button size="sm" onclick={() => (loginOpen = true)}>Login</Button>
			{/if}

			<!-- Mobile hamburger (Sheet trigger) -->
			<Sheet.Root>
				<Sheet.Trigger>
					{#snippet child({ props })}
						<button
							{...props}
							class="ml-2 flex flex-col gap-1 rounded p-2 hover:bg-blue-100 md:hidden"
							aria-label="Open menu"
						>
							<span class="block h-0.5 w-5 bg-gray-700"></span>
							<span class="block h-0.5 w-5 bg-gray-700"></span>
							<span class="block h-0.5 w-5 bg-gray-700"></span>
						</button>
					{/snippet}
				</Sheet.Trigger>
				<Sheet.Content side="right" class="w-64">
					<Sheet.Header>
						<div class="flex items-center gap-2 pb-4">
							<img src="/resto-rate-logo.svg" class="h-6 w-6" alt="App Logo" />
							<span class="font-semibold text-blue-800">Restorate</span>
						</div>
					</Sheet.Header>
					<hr class="mb-4 border-gray-200" />
					<nav class="flex flex-col gap-4 px-2">
						<a href="/" class="text-gray-700 hover:text-blue-700">Home</a>
						<a href="/about" class="text-gray-700 hover:text-blue-700">About</a>
						<a href="/pricing" class="text-gray-700 hover:text-blue-700">Pricing</a>
						<a href="/contact" class="text-gray-700 hover:text-blue-700">Contact</a>
					</nav>
				</Sheet.Content>
			</Sheet.Root>
		</div>
	</nav>
</header>

<LoginModal bind:open={loginOpen} />
```

> **Note on Sheet import paths:** shadcn-svelte generates a barrel file. The exact path may be `$lib/components/ui/sheet/index.js` or `$lib/components/ui/sheet.svelte`. Check what was generated after `bunx shadcn-svelte@latest add sheet` and adjust the import accordingly.

> **Note on Sheet.Trigger:** shadcn-svelte v2 uses the `child` snippet pattern for compound components. If the Sheet component doesn't support `{#snippet child}`, use a simpler `<Sheet.Trigger asChild>` pattern or just wrap in a plain button inside `<Sheet.Trigger>`.

---

## Task 7: Update LoginModal.svelte

**Files:**
- Modify: `apps/web/src/lib/ui/components/LoginModal.svelte`

**Step 1: Replace the entire file**

```svelte
<script lang="ts">
	import { Button } from '$lib/components/ui/button/index.js';
	import { Input } from '$lib/components/ui/input/index.js';
	import { Label } from '$lib/components/ui/label/index.js';
	import { X } from '@lucide/svelte';
	import client from '$lib/client/client';
	import { auth } from '$lib/state/auth.svelte';

	let { open = $bindable(false) } = $props<{ open: boolean }>();

	let username = $state('');
	let error = $state<string | null>(null);
	let loading = $state(false);

	function initDialog(el: HTMLDialogElement) {
		el.showModal();
		return {
			destroy() {
				if (el.open) el.close();
			}
		};
	}

	function handleBackdropClick(e: MouseEvent & { currentTarget: HTMLDialogElement }) {
		const rect = e.currentTarget.getBoundingClientRect();
		const inside =
			e.clientX >= rect.left &&
			e.clientX <= rect.right &&
			e.clientY >= rect.top &&
			e.clientY <= rect.bottom;
		if (!inside) open = false;
	}

	async function handleLogin() {
		if (!username.trim()) {
			error = 'Username is required';
			return;
		}
		error = null;
		loading = true;
		try {
			const res = await client.auth.login({ username: username.trim() });
			if (res.user) {
				auth.setUser(res.user);
			}
			username = '';
			open = false;
		} catch (e: unknown) {
			error = e instanceof Error ? e.message : 'Login failed';
		} finally {
			loading = false;
		}
	}

	function handleKeydown(e: KeyboardEvent) {
		if (e.key === 'Enter') handleLogin();
	}
</script>

{#if open}
	<dialog
		use:initDialog
		oncancel={() => (open = false)}
		onclick={handleBackdropClick}
		class="m-auto w-full max-w-[calc(100%-2rem)] rounded-lg bg-white p-0 shadow-xl backdrop:bg-gray-900/50 sm:max-w-sm"
	>
		<div class="flex flex-col gap-4 p-6">
			<div class="flex items-center justify-between">
				<h3 class="text-xl font-semibold text-gray-900">Sign in</h3>
				<button
					type="button"
					onclick={() => (open = false)}
					class="rounded-lg p-1.5 text-gray-400 hover:bg-gray-100 hover:text-gray-900"
					aria-label="Close"
				>
					<X class="h-5 w-5" />
				</button>
			</div>
			<div>
				<Label for="username" class="mb-2">Username</Label>
				<Input
					id="username"
					bind:value={username}
					placeholder="Enter your username"
					onkeydown={handleKeydown}
					disabled={loading}
				/>
				{#if error}
					<p class="mt-1 text-sm text-red-600">{error}</p>
				{/if}
			</div>
			<Button onclick={handleLogin} disabled={loading} class="w-full">
				{loading ? 'Signing in…' : 'Sign in'}
			</Button>
		</div>
	</dialog>
{/if}
```

Changes: swapped imports, replaced `Helper` with plain `<p>`, replaced `CloseOutline` with Lucide `X`, removed dark mode classes.

---

## Task 8: Update RestaurantSearchSv.svelte

**Files:**
- Modify: `apps/web/src/lib/ui/components/RestaurantSearchSv.svelte`

**Step 1: Replace only the import line and Input usage**

Change line 9 from:
```svelte
import { Input } from 'flowbite-svelte';
```
to:
```svelte
import { Input } from '$lib/components/ui/input/index.js';
```

The `<Input>` usage in the template is identical — shadcn's Input component accepts the same props (`type`, `bind:value`, `oninput`, `onkeydown`, `placeholder`, `class`). No other changes needed.

---

## Task 9: Update RestaurantCard.svelte

**Files:**
- Modify: `apps/web/src/lib/ui/components/RestaurantCard.svelte`

This is the largest change. Key transformations:
1. Remove all Flowbite imports; add Lucide imports
2. Remove `ratingIcon` helper (Flowbite-specific)
3. Replace `<Rating>/<Star>` with hand-rolled stars using Lucide `Star`
4. Replace `<Spinner>` with Lucide `Loader2` (animated via CSS)
5. Replace CSS max-width transition with Svelte `fly` transition on `{#if isExpanded}`
6. Swap 8 icon names

**Step 1: Replace the entire script block (lines 1–184)**

```svelte
<script lang="ts">
	import clients from '$lib/client/client';
	import type { Place } from '$lib/client/generated/google_maps/v1/google_maps_service_pb';
	import {
		PriceLevel,
		BusinessStatus
	} from '$lib/client/generated/google_maps/v1/google_maps_service_pb';
	import type { RestaurantProto } from '$lib/client/generated/restaurants/v1/restaurant_pb';
	import {
		MapPin,
		Pencil,
		Check,
		X,
		ChevronRight,
		ChevronLeft,
		Phone,
		Globe,
		Star,
		Loader2
	} from '@lucide/svelte';
	import { fly } from 'svelte/transition';
	import { v4 as uuidv4 } from 'uuid';

	const { restaurant, initialGoogleData = undefined } = $props<{
		restaurant: RestaurantProto;
		initialGoogleData?: Place;
	}>();

	// Local copies of editable DB fields
	let localName = $state(restaurant.name);
	let localAddress = $state(restaurant.address);

	// Inline edit state
	let isEditingName = $state(false);
	let isEditingAddress = $state(false);
	let editedName = $state('');
	let editedAddress = $state('');
	let isSaving = $state(false);
	let saveError = $state<string | null>(null);

	// Google panel state
	let isExpanded = $state(false);
	let googleData = $state<Place | null>(initialGoogleData ?? null);
	let isLoadingGoogle = $state(false);
	let googleError = $state<string | null>(null);

	const hasGoogle = $derived(!!restaurant.googlePlacesId);
	const isEditing = $derived(isEditingName || isEditingAddress);

	let status = $derived(
		googleData
			? (() => {
					switch (googleData.businessStatus) {
						case BusinessStatus.OPERATIONAL:
							return { label: 'Operational', color: 'text-green-600' };
						case BusinessStatus.CLOSED_TEMPORARILY:
							return { label: 'Temporarily closed', color: 'text-yellow-600' };
						case BusinessStatus.CLOSED_PERMANENTLY:
							return { label: 'Permanently closed', color: 'text-red-600' };
						default:
							return null;
					}
				})()
			: null
	);

	let priceLabel = $derived(
		googleData
			? (() => {
					const map: Partial<Record<PriceLevel, string>> = {
						[PriceLevel.FREE]: 'Free',
						[PriceLevel.INEXPENSIVE]: '$',
						[PriceLevel.MODERATE]: '$$',
						[PriceLevel.EXPENSIVE]: '$$$',
						[PriceLevel.VERY_EXPENSIVE]: '$$$$'
					};
					return map[googleData.priceLevel] ?? '';
				})()
			: ''
	);

	let hoursToday = $derived(
		googleData?.regularOpeningHours
			? (() => {
					const today = new Date().getDay(); // 0=Sun
					const idx = today === 0 ? 6 : today - 1; // Google: 0=Mon
					return googleData.regularOpeningHours!.weekdayText[idx] ?? null;
				})()
			: null
	);

	let amenities = $derived(
		googleData
			? [
					{ label: 'Dine-in', value: googleData.dineIn },
					{ label: 'Takeout', value: googleData.takeout },
					{ label: 'Delivery', value: googleData.delivery },
					{ label: 'Outdoor seating', value: googleData.outdoorSeating },
					{ label: 'Reservations', value: googleData.reservable }
				]
			: []
	);

	async function toggleExpand() {
		if (!isExpanded && !googleData && restaurant.googlePlacesId) {
			await fetchGoogleData();
		}
		isExpanded = !isExpanded;
	}

	async function fetchGoogleData() {
		isLoadingGoogle = true;
		googleError = null;
		try {
			googleData = await clients.googleMaps.getRestaurantDetails({
				name: restaurant.googlePlacesId,
				languageCode: 'pl',
				regionCode: 'pl'
			});
		} catch {
			googleError = 'Failed to load Google details.';
		} finally {
			isLoadingGoogle = false;
		}
	}

	function startEditName() {
		editedName = localName;
		isEditingName = true;
		isEditingAddress = false;
		saveError = null;
	}

	function startEditAddress() {
		editedAddress = localAddress;
		isEditingAddress = true;
		isEditingName = false;
		saveError = null;
	}

	function cancelEdit() {
		isEditingName = false;
		isEditingAddress = false;
		saveError = null;
	}

	async function saveChanges() {
		isSaving = true;
		saveError = null;
		try {
			const result = await clients.restaurants.updateRestaurant({
				id: restaurant.id,
				name: editedName,
				address: editedAddress,
				googlePlacesId: restaurant.googlePlacesId
			});
			localName = result.restaurant?.name ?? editedName;
			localAddress = result.restaurant?.address ?? editedAddress;
			isEditingName = false;
			isEditingAddress = false;
		} catch {
			saveError = 'Failed to save changes.';
		} finally {
			isSaving = false;
		}
	}

	function safeHostname(uri: string): string {
		try {
			return new URL(uri).hostname;
		} catch {
			return uri;
		}
	}

	function formatCreatedAt(unix: bigint | number): string {
		return new Date(Number(unix) * 1000).toLocaleDateString();
	}
</script>
```

**Step 2: Replace the template (lines 186–465)**

```svelte
<div
	class="flex w-fit overflow-hidden rounded-2xl bg-white shadow-xl transition-all duration-300 hover:shadow-2xl"
>
	<!-- ═══ Left panel: DB data ═══ -->
	<div class="flex w-80 flex-shrink-0 flex-col gap-5 p-6">
		<!-- Name -->
		<div class="group">
			{#if isEditingName}
				<input
					type="text"
					class="w-full rounded-lg border border-blue-300 px-2 py-1 text-xl font-bold text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"
					bind:value={editedName}
					onkeydown={(e) => e.key === 'Escape' && cancelEdit()}
				/>
			{:else}
				<div class="flex items-start justify-between gap-2">
					<h3 class="text-xl font-bold leading-tight text-gray-900">
						{localName}
					</h3>
					<button
						onclick={startEditName}
						class="mt-0.5 shrink-0 text-gray-400 opacity-0 transition-opacity hover:text-gray-600 group-hover:opacity-100"
						aria-label="Edit name"
					>
						<Pencil class="h-4 w-4" />
					</button>
				</div>
			{/if}
		</div>

		<!-- Address -->
		<div class="group flex-1">
			{#if isEditingAddress}
				<textarea
					class="w-full resize-none rounded-lg border border-blue-300 px-2 py-1 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
					rows="3"
					bind:value={editedAddress}
					onkeydown={(e) => e.key === 'Escape' && cancelEdit()}
				></textarea>
			{:else}
				<div class="flex items-start gap-2">
					<MapPin class="mt-0.5 h-5 w-5 shrink-0 text-gray-400" />
					<div class="flex flex-1 items-start justify-between gap-2">
						<p class="text-sm leading-relaxed text-gray-600">
							{localAddress || '—'}
						</p>
						<button
							onclick={startEditAddress}
							class="mt-0.5 shrink-0 text-gray-400 opacity-0 transition-opacity hover:text-gray-600 group-hover:opacity-100"
							aria-label="Edit address"
						>
							<Pencil class="h-4 w-4" />
						</button>
					</div>
				</div>
			{/if}
		</div>

		<!-- Save / Cancel controls -->
		{#if isEditing}
			<div class="flex flex-col gap-2">
				<div class="flex items-center gap-2">
					<button
						onclick={saveChanges}
						disabled={isSaving}
						class="flex items-center gap-1.5 rounded-lg bg-blue-600 px-3 py-1.5 text-sm font-medium text-white transition-colors hover:bg-blue-700 disabled:opacity-50"
					>
						{#if isSaving}
							<Loader2 class="h-4 w-4 animate-spin" />
						{:else}
							<Check class="h-4 w-4" />
						{/if}
						Save
					</button>
					<button
						onclick={cancelEdit}
						class="flex items-center gap-1.5 rounded-lg border border-gray-300 px-3 py-1.5 text-sm font-medium text-gray-600 transition-colors hover:bg-gray-50"
					>
						<X class="h-4 w-4" />
						Cancel
					</button>
				</div>
				{#if saveError}
					<p class="text-xs text-red-500">{saveError}</p>
				{/if}
			</div>
		{/if}

		<!-- Footer: created date + expand toggle -->
		<div class="mt-auto flex items-center justify-between pt-2">
			<span class="text-xs text-gray-400">
				{formatCreatedAt(restaurant.createdAt)}
			</span>
			{#if hasGoogle}
				<button
					onclick={toggleExpand}
					class="flex items-center gap-1.5 rounded-lg border border-gray-200 px-3 py-1.5 text-sm font-medium text-gray-600 transition-all hover:border-blue-300 hover:bg-blue-50 hover:text-blue-600"
				>
					{#if isExpanded}
						<ChevronLeft class="h-4 w-4" />
						Collapse
					{:else}
						<ChevronRight class="h-4 w-4" />
						Google details
					{/if}
				</button>
			{/if}
		</div>
	</div>

	<!-- ═══ Right panel: Google data (Svelte fly transition) ═══ -->
	{#if isExpanded}
		<div transition:fly={{ x: 50, duration: 300 }}>
			<!-- separator -->
			<div class="w-px self-stretch bg-gray-200"></div>

			<div class="flex h-full w-96 flex-col overflow-y-auto">
				{#if isLoadingGoogle}
					<div class="flex flex-1 items-center justify-center py-16">
						<Loader2 class="h-10 w-10 animate-spin text-gray-400" />
					</div>
				{:else if googleError}
					<div class="flex flex-1 flex-col items-center justify-center gap-3 py-16 text-center">
						<p class="text-sm text-red-500">{googleError}</p>
						<button
							onclick={fetchGoogleData}
							class="rounded-lg bg-blue-600 px-4 py-2 text-sm text-white transition-colors hover:bg-blue-700"
						>
							Retry
						</button>
					</div>
				{:else if googleData}
					<div class="space-y-5 p-6">
						<!-- Header -->
						<div class="flex items-center justify-between">
							<img src="/GoogleMaps_Logo_Gray.svg" alt="Google Maps" class="h-4 w-auto" />
							<span class="text-xs text-gray-400">Live · not cached</span>
						</div>

						<!-- Core info: rating, status, price -->
						<div class="space-y-2">
							{#if googleData.rating}
								<div class="flex items-center gap-3">
									<div class="flex items-center gap-0.5">
										{#each Array(5) as _, i}
											<Star
												class="h-4 w-4 {i < Math.round(googleData.rating)
													? 'fill-amber-400 text-amber-400'
													: 'fill-none text-gray-300'}"
											/>
										{/each}
										<span class="ml-1 text-sm font-semibold text-gray-800">
											{googleData.rating.toFixed(1)}
										</span>
									</div>
									{#if googleData.userRatingCount}
										<span class="text-xs text-gray-400">
											({googleData.userRatingCount.toLocaleString()} reviews)
										</span>
									{/if}
								</div>
							{/if}

							<div class="flex items-center gap-2">
								{#if status}
									<span class="text-sm font-medium {status.color}">{status.label}</span>
								{/if}
								{#if priceLabel}
									<span class="rounded bg-gray-100 px-1.5 py-0.5 text-xs font-semibold text-gray-700">
										{priceLabel}
									</span>
								{/if}
							</div>
						</div>

						<hr class="border-gray-200" />

						<!-- Contact & location -->
						<div class="space-y-3">
							{#if googleData.formattedAddress}
								<div class="flex items-start gap-2">
									<MapPin class="mt-0.5 h-4 w-4 shrink-0 text-gray-400" />
									<p class="text-sm leading-relaxed text-gray-600">
										{googleData.formattedAddress}
									</p>
								</div>
							{/if}
							{#if googleData.nationalPhoneNumber || googleData.internationalPhoneNumber}
								<div class="flex items-center gap-2">
									<Phone class="h-4 w-4 shrink-0 text-gray-400" />
									<a
										href="tel:{googleData.internationalPhoneNumber || googleData.nationalPhoneNumber}"
										class="text-sm text-blue-600 hover:underline"
									>
										{googleData.nationalPhoneNumber || googleData.internationalPhoneNumber}
									</a>
								</div>
							{/if}
							{#if googleData.websiteUri}
								<div class="flex items-center gap-2 overflow-hidden">
									<Globe class="h-4 w-4 shrink-0 text-gray-400" />
									<a
										href={googleData.websiteUri}
										target="_blank"
										rel="noopener noreferrer"
										class="truncate text-sm text-blue-600 hover:underline"
									>
										{safeHostname(googleData.websiteUri)}
									</a>
								</div>
							{/if}
							{#if googleData.googleMapsUri}
								<div class="flex items-center gap-2">
									<img src="/GoogleMaps_Logo_Gray.svg" alt="" class="h-3.5 w-auto shrink-0" />
									<a
										href={googleData.googleMapsUri}
										target="_blank"
										rel="noopener noreferrer"
										class="text-sm text-blue-600 hover:underline"
									>
										Open in Maps
									</a>
								</div>
							{/if}
						</div>

						<!-- Opening hours: today -->
						{#if hoursToday}
							<div>
								<hr class="mb-4 border-gray-200" />
								<h4 class="mb-1.5 text-xs font-semibold uppercase tracking-wide text-gray-400">
									Today's hours
								</h4>
								<p class="text-sm text-gray-600">{hoursToday}</p>
							</div>
						{/if}

						<!-- Amenities -->
						{#if amenities.length > 0}
							<div>
								<hr class="mb-4 border-gray-200" />
								<h4 class="mb-3 text-xs font-semibold uppercase tracking-wide text-gray-400">
									Features
								</h4>
								<div class="grid grid-cols-2 gap-2">
									{#each amenities as feature}
										<div class="flex items-center gap-1.5">
											{#if feature.value}
												<Check class="h-3.5 w-3.5 shrink-0 text-green-500" />
											{:else}
												<X class="h-3.5 w-3.5 shrink-0 text-gray-300" />
											{/if}
											<span class="text-xs text-gray-600">{feature.label}</span>
										</div>
									{/each}
								</div>
							</div>
						{/if}

						<!-- Attribution -->
						<div class="border-t border-gray-100 pt-3">
							<p class="text-xs text-gray-400">Data from Google Places API</p>
						</div>
					</div>
				{/if}
			</div>
		</div>
	{/if}
</div>
```

Note: The separator `<div class="w-px ...">` is now inside the `{#if isExpanded}` block (it only shows when expanded, which is correct behavior).

The `uuidv4` import is unused after removing `Rating` (which needed a unique id). Remove the import line `import { v4 as uuidv4 } from 'uuid';` from the script.

---

## Task 10: Verify and commit

**Step 1: Type-check the frontend**

```bash
cd apps/web && bun run check
```

Expected: `svelte-check` reports 0 errors. If there are errors about shadcn import paths (e.g., `$lib/components/ui/button/index.js`), check what files were actually generated by `bunx shadcn-svelte@latest add` and adjust import paths in Header, LoginModal, and RestaurantSearchSv accordingly. The generated structure varies by shadcn-svelte version — it may be `$lib/components/ui/button.svelte` (single file) or `$lib/components/ui/button/index.js` (directory with barrel).

**Step 2: Verify no flowbite references remain in source**

```bash
cd apps/web && grep -r "flowbite" src/
```

Expected: no output (zero matches).

**Step 3: Commit**

```bash
git add apps/web/src/ apps/web/package.json apps/web/components.json apps/web/src/lib/utils.ts
git commit -m "feat: migrate from flowbite-svelte to shadcn-svelte

- Remove flowbite, flowbite-svelte, flowbite-svelte-icons
- Initialize shadcn-svelte with default slate theme
- Replace Navbar/Drawer with shadcn Sheet + semantic HTML
- Replace Flowbite Button/Input/Label with shadcn equivalents
- Replace Rating/Star with hand-rolled stars using @lucide/svelte
- Replace Spinner with Loader2 animate-spin
- Swap 8 flowbite-svelte-icons for @lucide/svelte equivalents
- Replace CSS max-width transition with Svelte fly transition
- Remove Flowbite ThemeProvider and custom theme config

Co-Authored-By: Claude Sonnet 4.6 <noreply@anthropic.com>"
```

---

## Troubleshooting

**shadcn-svelte Sheet import path doesn't work:**
After running `bunx shadcn-svelte@latest add sheet`, check what files exist:
```bash
ls apps/web/src/lib/components/ui/
```
Adjust imports to match actual generated filenames.

**`fly` transition causes layout shift:**
The right panel is now conditionally rendered (`{#if isExpanded}`). If the outer card `flex` container collapses when the panel unmounts, this is correct behavior. If the card looks wrong, check that `w-fit` on the outer div is handling the width correctly.

**shadcn Button size/variant props differ:**
shadcn Button uses `size="sm"` and `variant="outline"` (same as shadcn). Adjust if the generated component uses different prop names.

**Tailwind v4 CSS variables not recognized:**
shadcn-svelte's init for Tailwind v4 writes variables differently than v3. If colors like `bg-background` don't resolve, check that `app.css` has the `@layer base` block with `:root { --background: ... }` variables generated by the init command.
